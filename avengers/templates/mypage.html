{% extends 'base.html' %}

{% load static %}

{% block title %}Community Room | Avengers{% endblock %}

{% block active_message_list %}active{% endblock %}

{% block contents %}
<div class="container">
    <div class="adsence-left" style="margin-top:7.5vw;float:left;">
    </div>
    <div class="adsence-right" style="margin-top:7.5vw;display:flex;flex-direction:column;align-items:right;float:right;">
    </div>

    <div class="row">
        <div class="my-div-style w-100">
            <div class="col-lg-8 col-md-10 mx-auto">
                <h1 class="fs-2 fs-6">ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ¼ã‚¹ãƒ¬ãƒƒãƒ‰</h1>
                <p>ã“ã®ãƒšãƒ¼ã‚¸ã¯ä¼šå“¡æ§˜åŒå£«ã§äº¤æµã—ãŸã‚Šã€äººé–“é–¢ä¿‚ã®æ‚©ã¿ã‚’æ‰“ã¡æ˜ã‘ãŸã‚Šã€ä¼šå“¡æ§˜åŒå£«ã§æ–°ãŸãªã¤ãªãŒã‚Šã‚’ä½œã£ã¦ã„ãŸã ããŸã‚ã«ç”¨æ„ã•ã›ã¦ã„ãŸã ã„ãŸæ²ç¤ºæ¿ã§ã™ã€‚æ—¥é ƒã‚¹ãƒˆãƒ¬ã‚¹ã¨ãªã£ã¦ã„ã‚‹ã“ã¨ã‚„æ‚©ã¿ã®ç¨®ã¨ãªã£ã¦ã„ã‚‹ä¸Šå¸ã‚„åŒåƒšã€éƒ¨ä¸‹ã®ã“ã¨ã‚’è‡ªç”±ã«æ›¸ã„ã¦ã„ãŸã ã‘ãŸã‚‰ã¨æ€ã„ã¾ã™ã€‚</p>
                <p style="color:red;">ãªãŠã€åˆ©ç”¨è¦ç´„ã«ã‚‚æ›¸ã„ã¦ã‚ã‚Šã¾ã™ãŒã€ä»–ã®ä¼šå“¡æ§˜ã‚’èª¹è¬—ä¸­å‚·ã—ãŸã‚Šã€æš´è¨€ã‚’æ›¸ãè¾¼ã‚“ã ã‚Šã™ã‚‹è¡Œç‚ºã¯å³ç¦ã§ã™ã€‚ãã®ã‚ˆã†ãªã‚³ãƒ¡ãƒ³ãƒˆã¯è¦‹ã‹ã‘æ¬¡ç¬¬å‰Šé™¤ã—ã¾ã™ã—ã€ä½•åº¦ã‚‚ãã†ã„ã£ãŸè¶£æ—¨ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿ã™ã‚‹æ‚ªè³ªãªãƒ¦ãƒ¼ã‚¶ãƒ¼æ§˜ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯æ¶ˆå»ã—ã¾ã™ã€‚ã¾ãŸã€ã“ã¡ã‚‰ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã¯è¨¼æ‹ éŸ³å£°ã‚„å‹•ç”»ã€ç”»åƒã®æŠ•ç¨¿ã«ã¯å¯¾å¿œã—ã¦ãŠã‚Šã¾ã›ã‚“ã€‚ãã‚Œãã‚Œã‚‚åŠ å®³è€…ã®å®Ÿåã‚„ä¼šç¤¾åã¯ã“ã“ã§ã¯å‡ºã•ãªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚</p>
                <div class="clearfix">
                    <a href="{% url 'avengers:community_room' %}" class="btn btn-success mb-1" style="padding:0.2rem;">ãƒšãƒ¼ã‚¸ã‚’æ›´æ–°</a>
                    <a href="{% url 'avengers:post-create' %}" class="btn btn-primary mb-1" style="padding:0.2rem;">æ–°è¦æŠ•ç¨¿</a>
                    <a href="{% url 'avengers:user-posts' user.username %}" class="btn btn-secondary mb-1" style="padding:0.2rem;">ã‚ãªãŸã®æŠ•ç¨¿</a>
                    <a href="{% url 'avengers:user-follows' user.username %}" class="btn btn-sm btn-outline-primary mb-1">ãƒ•ã‚©ãƒ­ãƒ¼ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼</a>
                    <a href="{% url 'avengers:user-followers' user.username %}" class="btn btn-sm btn-outline-primary mb-1">ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼</a>
                </div>
                <hr>
                <div class="clearfix" style="text-align:center">
                    <a href="{% url 'avengers:dm_list' %}" class="btn btn-sm btn-outline-primary mb-1">é€ã‚‰ã‚ŒãŸãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã™ã‚‹</a>
                    <a href="{% url 'avengers:dm_send_list' %}" class="btn btn-sm btn-outline-primary mb-1">é€ã£ãŸãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã™ã‚‹</a>
                </div>
                <hr>
                {% if user.is_superuser %}
                <p>ç®¡ç†è€…ç”¨ã‚¹ãƒ¬ãƒƒãƒ‰æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ </p>
                <form method="GET" action="{% url 'avengers:community_room' %}">
                    <input class="input_form" type="text" name="keyword">
                    <button type="submit" class="btn btn-primary" style="border-radius:0.3rem;padding-top:0.5rem;padding-bottom:0.4rem;">çµã‚Šè¾¼ã¿</button>
                </form>
                {% elif user.is_staff %}
                <p>ç®¡ç†è€…ç”¨ã‚¹ãƒ¬ãƒƒãƒ‰æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ </p>
                <form method="GET" action="{% url 'avengers:community_room' %}">
                    <input class="input_form" type="text" name="keyword">
                    <button type="submit" class="btn btn-primary" style="border-radius:0.3rem;padding-top:0.5rem;padding-bottom:0.4rem;">çµã‚Šè¾¼ã¿</button>
                </form>
                {% endif %}
                {%  if user_profile is not None and user_profile.id != user.id  and user.username != '' %}
                    {%  if user_profile != None %}
                        <div class="mt-2 d-flex full-width align-items-center">
                            <img
                                class="rounded-circle"
                                style="width: 200px; height: 200px;"
                                src="{{ user_profile.profile.image.url }}">
                            <div>
                                <h4 style="text-align: left"
                                        class="white-important">
                                    ãƒ¦ãƒ¼ã‚¶ãƒ¼å:{{ user_profile.username }}
                                </h4>
                            </div>
                        </div>
                    {%  else %}
                        <div class="mt-2 d-flex full-width align-items-center">
                            <img
                                class="rounded-circle"
                                style="width: 200px; height: 200px;"
                                src="{{ user.profile.image.url }}">
                            <div>
                                <h4 style="text-align: left"
                                        class="white-important">
                                    ãƒ¦ãƒ¼ã‚¶ãƒ¼å:{{ user.username }}
                                </h4>
                            </div>
                        </div>
                    {%  endif %}
                    <form method="POST">
                        {% csrf_token %}
                        <div class="form-group">
                            <button class="btn btn-sm btn-outline-primary"
                                    name="{% if can_follow %}follow{% else %}unfollow{% endif %}"
                                    type="submit">
                                {% if can_follow %}
                                    ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹
                                {% else %}
                                    ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ•ã‚©ãƒ­ãƒ¼ã‚’å¤–ã™
                                {% endif %}
                            </button>
                        </div>
                    </form>
                {% endif %}
                <h3>æŠ•ç¨¿ä¸€è¦§</h3>
                <hr>
                {% for post in posts %}
                <article class="media content-section hovered-tweet">
                    <div style="width: 100%; word-break: break-all;">
                        <div class="pb-2 row m-0" style="width: 100%; margin-right: 0 !important;">
                            <div
                               style="padding-left: 0px !important;"
                               class="col-6 no-padding d-flex align-items-center">
                            <img
                               class="rounded-circle mr-2"
                               style="width: 30px; height: 30px;"
                               src="{{ post.author.profile.image.url }}">
                            <a class="mr-2 white-important" href="{% url 'avengers:user-posts' post.author %}">
                               {{ post.author }}
                            </a>
                            </div>
                            <div class="col-6 d-flex flex-row-reverse no-padding align-items-center"
                            style="padding-right: 0 !important;">
                            {% if post.author == user %}
                                <a class="material-icons ml-2"
                                   style="font-size: 14px"
                                        href="{% url 'avengers:post-delete' post.id %}">å‰Šé™¤</a>
                                <a class="material-icons ml-2"
                                   style="font-size: 14px"
                                        href="{% url 'avengers:post-update' post.id %}">æ›´æ–°</a>
                            {%  endif %}
                            </div>
                        </div>
                        <a href="{% url 'avengers:post-detail' post.id %}">
                            <p class="mb-4">
                                {{ post.content }}
                            </p>
                            <p>æŠ•ç¨¿æ—¥æ™‚:{{ post.date_posted }}</p>
                            {% if user.is_superuser %}
                            <p>æŠ•ç¨¿è€…ID:{{ post.author.id }}ã€€ã€€ã€€ã€€ã‚¹ãƒ¬ãƒƒãƒ‰ID:{{ post.id }}</p>
                            {% elif user.is_staff %}
                            <p>æŠ•ç¨¿è€…ID:{{ post.author.id }}ã€€ã€€ã€€ã€€ã‚¹ãƒ¬ãƒƒãƒ‰ID:{{ post.id }}</p>
                            {% endif %}
                        </a>
                        <span class="text-info">
                            ã„ã„ã­!={{ post.good_count }}  ã‚³ãƒ¡ãƒ³ãƒˆæ•°={{ post.number_of_comments }}
                        </span>
                        <ul class="float-right" style="list-style-type:none;text-align:right;">
                            <li><a href="{% url 'avengers:good' post.id %}"><button class="text-white" style="background-color:#ee0979;border-color:#ee0979;border-radius:0.25rem;">ğŸ’›ã„ã„ã­!ã™ã‚‹</button></a></li>
                            <li><a href="{% url 'avengers:report3' post.id %}"><button class="text-white btn-danger" style="border-radius:0.25rem;margin-top:0.4rem;">é€šå ±ã™ã‚‹</button></a></li>
                            {% if user.is_superuser %}
                                <li><a class="btn btn-danger" href="{% url 'avengers:thread_delete' post.id %}" style="padding:0.1rem;margin-top:0.6rem;">ã“ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’å‰Šé™¤ã™ã‚‹</a></li>
                            {% elif user.is_staff %}
                                <li><a class="btn btn-danger" href="{% url 'avengers:thread_delete' post.id %}" style="padding:0.1rem;margin-top:0.6rem;">ã“ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’å‰Šé™¤ã™ã‚‹</a></li>
                            {% endif %}
                        </ul>
                        {%  if user_profile is not None and user_profile.id != user.id  and user.username != '' %}
                        <form method="POST">
                            {% csrf_token %}
                            <div class="form-group">
                                <button class="btn btn-sm btn-outline-primary"
                                        name="{% if can_follow %}follow{% else %}unfollow{% endif %}"
                                        type="submit">
                                    {% if can_follow %}
                                        ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹
                                    {% else %}
                                        ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ•ã‚©ãƒ­ãƒ¼ã‚’å¤–ã™
                                    {% endif %}
                                </button>
                            </div>
                        </form>
                        {% endif %}
                    </div>
                </article>
                <hr>
                {% empty %}
                <p>ã¾ã æ–°ã—ã„æŠ•ç¨¿ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                {% endfor %}

                <!-- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç† -->
                {% if is_paginated %}
                    <ul class="pagination">
                        <!-- å‰ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ -->
                        {% if page_obj.has_previous %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ page_obj.previous_page_number }}">
                                    <span aria-hidden="true">&laquo;</span>
                                </a>
                            </li>
                        {% endif %}

                        <!-- ãƒšãƒ¼ã‚¸æ•°è¡¨ç¤º -->
                        {% for page_num in page_obj.paginator.page_range %}
                            {% if page_obj.number == page_num %}
                                <li class="page-item active"><a class="page-link" href="#">{{ page_num }}</a></li>
                            {% else %}
                                <li class="page-item"><a class="page-link" href="?page={{ page_num }}">{{ page_num }}</a></li>
                            {% endif %}
                        {% endfor %}

                        <!-- æ¬¡ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ -->
                        {% if page_obj.has_next %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ page_obj.next_page_number }}">
                                    <span aria-hidden="true">&raquo;</span>
                                </a>
                            </li>
                        {% endif %}
                    </ul>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}