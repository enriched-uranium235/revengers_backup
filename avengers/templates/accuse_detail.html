{% extends 'base.html' %}
{% load static %}

{% block title %}投稿詳細 | Avengers{% endblock %}

{% block active_accuse_list %}active{% endblock %}


{% block contents %}
<div class="adsence_top" style="margin-top:5rem;text-align:center;">
</div>
<div class="container">
    <div class="mt-3">

        {% if object.photo1 %}

        <div class="row">
            <div class="col-3">
                <strong>写真</strong>
            </div>
            <div class="col-3">
                <img src="{{ object.photo1.url }}" class="accuse_photo_size" width="800" height="500"/>
            </div>
        </div>

        <hr>

        {% endif %}

        {% if object.media1 %}

        <div class="row">
            <div class="col-3">
                <strong>音声</strong>
            </div>
            <div class="col-3">
                <figure>
                    <figcaption>証拠音声</figcaption>
                    <audio controls
                           src="{{ object.media1.url }}" class="accuse_sound_size">
                        申し訳ありません、お使いのブラウザは音声に対応しておりません。
                    </audio>
                </figure>
            </div>
        </div>

        <hr>

        {% endif %}

        {% if object.media2 %}

        <div class="row">
            <div class="col-3">
                <strong>動画</strong>
            </div>
            <div class="col-3">
                <video controls class="accuse_video_size" width="800" height="500">
                    <source src="{{ object.media2.url }}">
                    申し訳ありません、お使いのブラウザはビデオに対応しておりません。
                </video>
            </div>
        </div>

        <hr>

        {% endif %}

        <div class="row">
            <div class="col-3">
                <strong>投稿したユーザー</strong>
            </div>
            <div class="col-9">
                <article>
                {%  if user_profile != None %}
                    <a href="{% url 'avengers:user-posts' object.user %}"><img class="rounded-circle"
                         style="width: 60px; height: 60px;"
                         src="{{ avengers.user_profile.profile.image.url }}"></a>
                    {{ object.user }}
                {%  else %}
                    <a href="{% url 'avengers:user-posts' object.user %}"><img class="rounded-circle"
                         style="width: 40px; height: 40px;"
                         src="{{ avengers.user.profile.image.url }}"></a>
                    {{ object.user }}
                {%  endif %}
                </article>
            </div>
        </div>

        <hr>

        <div class="row">
            <div class="col-3">
                <strong>被害内容</strong>
            </div>
            <div class="col-9">
                {{ object.title }}
            </div>
        </div>

        <hr>

        <div class="row">
            <div class="col-3">
                <strong>所属団体名・加害者名</strong>
            </div>
            <div class="col-9">
                {{ object.group|linebreaksbr }}
            </div>
        </div>

        <hr>

        <div class="row">
            <div class="col-3">
                <strong>被害内容詳細</strong>
            </div>
            <div class="col-9">
                {{ object.content|linebreaksbr }}
            </div>
        </div>

        <hr>

        <div class="row">
            <div class="col-3">
                <strong>作成日時</strong>
            </div>
            <div class="col-9">
                {{ object.created_at }}
            </div>
        </div>

        <hr>

        <div class="row">
            <div class="col-3">
                <strong>更新日時</strong>
            </div>
            <div class="col-9">
                {{ object.updated_at }}
            </div>
        </div>

        <hr>

        <a href="{% url 'avengers:comment_view' object.pk %}" class="btn btn-secondary">コメントする</a>
        <a href="javascript:void(0);" onclick="window.history.back();" class="btn btn-success">戻る</a>
        <a href="{% url 'avengers:good3' object.pk %}" class="btn btn-primary">いいね！💛{{ object.good_count }}</a>
        <a href="{% url 'avengers:add_favorite' object.pk %}" class="btn btn-secondary" role="button" style="background-color:#f0f000;border-color:#f0f000;margin-right:0.1rem;">★お気に入り登録</a>
        <hr>
        <a href="{% url 'avengers:report1' object.pk %}" class="btn btn-danger">この投稿を通報する</a>
        {% if user.is_superuser %}
        <a href="{% url 'avengers:accuse_delete' object.pk %}" class="btn btn-danger">この投稿を削除する</a>
        {% elif user.is_staff %}
        <a href="{% url 'avengers:accuse_delete' object.pk %}" class="btn btn-danger">この投稿を削除する</a>
        {% endif %}

        <hr>
    </div>
</div>

<div class="adsence-bottom" style="text-align:center;">
</div>

<div class="container">
    <div>
        <p class="float-right">コメント件数:{{ comment_c }}件</p>
        <h2 class="title is-5">コメント一覧</h2>
        {% for comment in com_list %}
        <div class="row">
            <div class="col-12">
                <p>コメント：{{ comment.content }}</p>
                <p>コメント日時:{{ comment.created_at }}</p>
                <article>
                {%  if user_profile != None %}
                    <p>コメント投稿者：<a href="{% url 'avengers:user-posts' comment.user %}"><img class="rounded-circle"
                         style="width: 40px; height: 40px;"
                         src="{{ comment.user_profile.profile.image.url }}"></a>{{ comment.user }}</p>
                {%  else %}
                    <p>コメント投稿者：<a href="{% url 'avengers:user-posts' comment.user %}"><img class="rounded-circle"
                         style="width: 40px; height: 40px;"
                         src="{{ comment.user.profile.image.url }}"></a>{{ comment.user }}</p>
                {%  endif %}
                {% if user.is_superuser %}
                    <p class="float-right">コメントid:{{ comment.pk }}</p>
                {% elif user.is_staff %}
                    <p class="float-right">コメントid:{{ comment.pk }}</p>
                {% endif %}
                </article>
                <a href="{% url 'avengers:reply_create' comment.pk %}" class="btn btn-secondary">返信する</a>
                <a href="{% url 'avengers:good4' object.pk comment.pk %}" class="btn btn-primary">いいね！💛{{ comment.good_count }}</a>
                <a href="{% url 'avengers:report2' object.pk comment.pk %}" class="btn btn-danger">通報する</a>
                {% if user.is_superuser %}
                    <hr>
                    <a href="{% url 'avengers:comment_delete' comment.pk %}" class="btn btn-danger">コメントを消去する</a>
                {% elif user.is_staff %}
                    <hr>
                    <a href="{% url 'avengers:comment_delete' comment.pk %}" class="btn btn-danger">コメントを消去する</a>
                {% endif %}
                {% with reply_list=comment.comment_set.all %}
                    {% include 'reply.html' %}
                {% endwith %}
                <hr>
            </div>
        </div>
        {% empty %}
        <h5>まだコメントが投稿されていません。</h5>
        {% endfor %}
    </div>
</div>

{% endblock %}