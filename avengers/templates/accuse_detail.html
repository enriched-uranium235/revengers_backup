{% extends 'base.html' %}
{% load static %}

{% block title %}æŠ•ç¨¿è©³ç´° | Vengeancers{% endblock %}

{% block active_accuse_list %}active{% endblock %}

{% block head %}
<style>
    .trigger {
        border-style: double;
        border-color: #898989;
    }

    .guide {
        width:30px;
        height:30px;
    }

    .is_hide {
        display:none;
    }
</style>
<script>
    function api_like_{{object.pk}}() {
        var api_url = "{% url 'avengers:good2' object.pk %}";
        var btn = document.getElementById("like");
        var request = new XMLHttpRequest();
        request.onreadystatechange = function () {
            if (request.readyState === 4 && request.status === 200) {
                var received_data = JSON.parse(request.responseText);
                btn.innerText = received_data.like;
                splash(received_data.message,{
                    message_class: 'splashmsg default',
                    fadein_sec: 0.1,
                    wait_sec: 1.5,
                    fadeout_sec: 1.5,
                    opacity: 0.9,
                    trans_in: 'ease-in',
                    trans_out: 'ease-out',
                    outer_style: 'top: 0px;left: 0px;position: fixed;z-index: 1000;width: 100%;height: 100%;', //å¤–å´ã®ã‚¹ã‚¿ã‚¤ãƒ«
                    message_style: 'padding:0.5em;font-size:25px;color:white;background-color:#9aefa9; position: absolute;top: 50%; left: 50%;transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);', //ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ«
                })
            }
        }
        request.open("GET",api_url);
        request.send();
    }
</script>
<script>
    function api_report_{{object.pk}}() {
        var api_url = "{% url 'avengers:report1' object.pk %}";
        var btn = document.getElementById("report");
        var request = new XMLHttpRequest();
        request.onreadystatechange = function () {
            if (request.readyState === 4 && request.status === 200) {
                var received_data = JSON.parse(request.responseText);
            }
        }
        request.open("GET",api_url);
        request.send();
        splash("é€šå ±ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ç®¡ç†è€…å´ã§ç¢ºèªã®ä¸Šå³æ­£ã«å¯¾å‡¦ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚",{
            message_class: 'splashmsg default', //ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ã«è¨­å®šã™ã‚‹ã‚¯ãƒ©ã‚¹
            fadein_sec: 0.1, //ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ã™ã‚‹æ™‚é–“ï¼ˆç§’ï¼‰
            wait_sec: 1.5, //ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã‚’é–‹å§‹ã™ã‚‹æ™‚é–“ï¼ˆç§’ï¼‰
            fadeout_sec: 1.5, //ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã™ã‚‹æ™‚é–“ï¼ˆç§’ï¼‰
            opacity: 0.9, //ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€éç‡
            trans_in: 'ease-in', //ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ã®åŠ é€Ÿåº¦è¨­å®šï¼ˆCSSã®transitionå‚ç…§ï¼‰
            trans_out: 'ease-out', //ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã®åŠ é€Ÿåº¦è¨­å®šï¼ˆCSSã®transitionå‚ç…§ï¼‰
            outer_style: 'top: 0px;left: 0px;position: fixed;z-index: 1000;width: 100%;height: 100%;', //å¤–å´ã®ã‚¹ã‚¿ã‚¤ãƒ«
            message_style: 'padding:0.5em;font-size:25px;color:white;background-color:#9aefa9; position: absolute;top: 50%; left: 50%;transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);', //ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ«
        });
    }
</script>
<script>
    function api_favorite_{{object.pk}}() {
        var api_url = "{% url 'avengers:add_favorite' object.pk %}";
        var btn = document.getElementById("favorite");
        var request = new XMLHttpRequest();
        request.onreadystatechange = function () {
            if (request.readyState === 4 && request.status === 200) {
                var received_data = JSON.parse(request.responseText);
            }
        }
        request.open("GET",api_url);
        request.send();
        splash("ã“ã®æŠ•ç¨¿ã‚’ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ ã—ã¾ã—ãŸã€‚",{
            message_class: 'splashmsg default', //ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ã«è¨­å®šã™ã‚‹ã‚¯ãƒ©ã‚¹
            fadein_sec: 0.1, //ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ã™ã‚‹æ™‚é–“ï¼ˆç§’ï¼‰
            wait_sec: 1.5, //ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã‚’é–‹å§‹ã™ã‚‹æ™‚é–“ï¼ˆç§’ï¼‰
            fadeout_sec: 1.5, //ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã™ã‚‹æ™‚é–“ï¼ˆç§’ï¼‰
            opacity: 0.9, //ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€éç‡
            trans_in: 'ease-in', //ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ã®åŠ é€Ÿåº¦è¨­å®šï¼ˆCSSã®transitionå‚ç…§ï¼‰
            trans_out: 'ease-out', //ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã®åŠ é€Ÿåº¦è¨­å®šï¼ˆCSSã®transitionå‚ç…§ï¼‰
            outer_style: 'top: 0px;left: 0px;position: fixed;z-index: 1000;width: 100%;height: 100%;', //å¤–å´ã®ã‚¹ã‚¿ã‚¤ãƒ«
            message_style: 'padding:0.5em;font-size:25px;color:white;background-color:#9aefa9; position: absolute;top: 50%; left: 50%;transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);', //ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ«
        });
    }
</script>
{% endblock %}

{% block contents %}
{% if object.photo1 %}
<div class="my-div-style">
    <div class="text-center">
        <img src="{{ object.photo1.url }}" class="accuse_photo_size"/>
    </div>
</div>

<hr>

{% endif %}

{% if object.media1 %}

<div class="my-div-style">
    <div class="text-center">
        <figure>
            <figcaption>è¨¼æ‹ éŸ³å£°</figcaption>
            <audio controls
                   src="{{ object.media1.url }}" class="accuse_sound_size">
                ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯éŸ³å£°ã«å¯¾å¿œã—ã¦ãŠã‚Šã¾ã›ã‚“ã€‚
            </audio>
        </figure>
    </div>
</div>

<hr>

{% endif %}

{% if object.media2 %}

<div class="my-div-style">
    <div class="text-center">
        <video class="accuse_video_size" src="{{ object.media2.url }}" controls muted autoplay playinline></video>
        <script>
            var message = splash("ãƒŸãƒ¥ãƒ¼ãƒˆã¯å„è‡ªã§è§£é™¤ãŠé¡˜ã„è‡´ã—ã¾ã™ã€‚",{
                message_class: 'splashmsg default', //ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ã«è¨­å®šã™ã‚‹ã‚¯ãƒ©ã‚¹
                fadein_sec: 0.1, //ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ã™ã‚‹æ™‚é–“ï¼ˆç§’ï¼‰
                wait_sec: 1.5, //ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã‚’é–‹å§‹ã™ã‚‹æ™‚é–“ï¼ˆç§’ï¼‰
                fadeout_sec: 0.5, //ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã™ã‚‹æ™‚é–“ï¼ˆç§’ï¼‰
                opacity: 0.9, //ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€éç‡
                trans_in: 'ease-in', //ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ã®åŠ é€Ÿåº¦è¨­å®šï¼ˆCSSã®transitionå‚ç…§ï¼‰
                trans_out: 'ease-out', //ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã®åŠ é€Ÿåº¦è¨­å®šï¼ˆCSSã®transitionå‚ç…§ï¼‰
                outer_style: 'top: 0px;left: 0px;position: fixed;z-index: 1000;width: 100%;height: 100%;', //å¤–å´ã®ã‚¹ã‚¿ã‚¤ãƒ«
                message_style: 'padding:0.5em;font-size:25px;color:white;background-color:#9aefa9;position: absolute;top: 50%; left: 50%;transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);', //ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ«
            });

            setTimeout(message, 500);
        </script>
    </div>
</div>

<hr>

{% endif %}
<div class="container">
    <div>
        <div class="row">
            <div class="col-3">
                <strong>æŠ•ç¨¿ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼</strong>
            </div>
            <div class="col-9">
                <article>
                {%  if user_profile != None %}
                    <a href="{% url 'avengers:user-posts' object.user %}"><img class="rounded-circle"
                         style="width: 60px; height: 60px;"
                         src="{{ avengers.user_profile.profile.image.url }}"></a>
                    {{ object.user }}
                {%  else %}
                    <a href="{% url 'avengers:user-posts' object.user %}"><img class="rounded-circle"
                         style="width: 40px; height: 40px;"
                         src="{{ avengers.user.profile.image.url }}"></a>
                    {{ object.user }}
                {%  endif %}
                </article>
            </div>
        </div>

        <hr>

        <div class="row">
            <div class="col-3">
                <strong>è¢«å®³å†…å®¹</strong>
            </div>
            <div class="col-9">
                {{ object.title }}
            </div>
        </div>

        <hr>

        <div class="row">
            <div class="col-3">
                <strong>ä¼šç¤¾åãƒ»å­¦æ ¡åãƒ»åŠ å®³è€…å</strong>
            </div>
            <div class="col-9">
                {{ object.group|linebreaksbr }}
            </div>
        </div>

        <hr>

        <div class="row">
            <div class="col-3">
                <strong>è¢«å®³å†…å®¹è©³ç´°</strong>
            </div>
            <div class="col-9">
                {{ object.content|linebreaksbr }}
            </div>
        </div>

        <hr>

        <div class="row">
            <div class="col-3">
                <strong>ä½œæˆæ—¥æ™‚</strong>
            </div>
            <div class="col-9">
                {{ object.created_at }}
            </div>
        </div>

        <hr>

        <div class="row">
            <div class="col-3">
                <strong>æ›´æ–°æ—¥æ™‚</strong>
            </div>
            <div class="col-9">
                {{ object.updated_at }}
            </div>
        </div>

        <hr>

        <a href="{% url 'avengers:comment_view' object.pk %}" class="btn btn-secondary">ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹</a>
        <a href="javascript:void(0);" onclick="window.history.back();" class="btn btn-success">æˆ»ã‚‹</a>
        <a onclick="api_like_{{object.pk}}()" class="btn btn-primary text-white">ã„ã„ã­ï¼ğŸ’›<span id="like">{{ object.good_count }}</span></a>
        <a onclick="api_favorite_{{object.pk}}()" class="btn btn-warning text-white">â˜…ãŠæ°—ã«å…¥ã‚Šç™»éŒ²</a>
        <hr>
        <a onclick="api_report_{{object.pk}}()" class="btn btn-danger text-white report">é€šå ±<span id="report">{{object.is_reported}}</span></a>
        {% if user.is_superuser %}
        <a href="{% url 'avengers:accuse_delete' object.pk %}" class="btn btn-danger">ã“ã®æŠ•ç¨¿ã‚’å‰Šé™¤ã™ã‚‹</a>
        {% elif user.is_staff %}
        <a href="{% url 'avengers:accuse_delete' object.pk %}" class="btn btn-danger">ã“ã®æŠ•ç¨¿ã‚’å‰Šé™¤ã™ã‚‹</a>
        {% endif %}

        <hr>
    </div>
</div>

<div class="adsence-bottom" style="text-align:center;">
</div>

<div class="container">
    <div>
        <div class="trigger pt-2" onclick="changePhoto();">
            <h3 class="title is-5">ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§<img id="target1" class="guide ml-3" src="{% static 'img/down_arrow.png' %}"><img id="target2" class="guide is_hide ml-3 p-1" src="{% static 'img/up_arrow.png' %}"></h3>
        </div>
        <hr>
        <p>ã‚³ãƒ¡ãƒ³ãƒˆä»¶æ•°:{{ comment_c }}ä»¶</p>
        <hr>
        <div class="switch is_hide">
            {% for comment in com_list %}
            <div class="row">
                <div class="col-12">
                    <p>ã‚³ãƒ¡ãƒ³ãƒˆï¼š{{ comment.content }}</p>
                    <p>ã‚³ãƒ¡ãƒ³ãƒˆæ—¥æ™‚:{{ comment.created_at }}</p>
                    <article>
                    {%  if user_profile != None %}
                        <p>ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿è€…ï¼š<a href="{% url 'avengers:user-posts' comment.user %}"><img class="rounded-circle"
                             style="width: 40px; height: 40px;"
                             src="{{ comment.user_profile.profile.image.url }}"></a>{{ comment.user }}</p>
                    {% else %}
                        <p>ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿è€…ï¼š<a href="{% url 'avengers:user-posts' comment.user %}"><img class="rounded-circle"
                             style="width: 40px; height: 40px;"
                             src="{{ comment.user.profile.image.url }}"></a>{{ comment.user }}</p>
                    {%  endif %}
                    {% if user.is_superuser %}
                        <p class="float-right">ã‚³ãƒ¡ãƒ³ãƒˆid:{{ comment.pk }}</p>
                    {% elif user.is_staff %}
                        <p class="float-right">ã‚³ãƒ¡ãƒ³ãƒˆid:{{ comment.pk }}</p>
                    {% endif %}
                    </article>
                    {% include 'accuse_detail_comment_like.html' %}
                    <a href="{% url 'avengers:reply_create' comment.pk %}" class="btn btn-secondary">è¿”ä¿¡ã™ã‚‹</a>
                    {% include 'accuse_comment_report.html' %}
                    {% if user.is_superuser %}
                        <hr>
                        <a href="{% url 'avengers:comment_delete' comment.pk %}" class="btn btn-danger">ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ¶ˆå»ã™ã‚‹</a>
                    {% elif user.is_staff %}
                        <hr>
                        <a href="{% url 'avengers:comment_delete' comment.pk %}" class="btn btn-danger">ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ¶ˆå»ã™ã‚‹</a>
                    {% endif %}
                    {% with reply_list=comment.comment_set.all %}
                        {% include 'reply.html' %}
                    {% endwith %}
                    <hr>
                </div>
            </div>
            {% empty %}
            <h5>ã¾ã ã‚³ãƒ¡ãƒ³ãƒˆãŒæŠ•ç¨¿ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</h5>
            {% endfor %}
        </div>
    </div>
</div>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>
    $(".trigger").click(function () {
        $(".switch").slideToggle();
    });

    let Element = document.getElementById('target1');
    let Element2 = document.getElementById('target2');

    function changePhoto() {
        Element.classList.toggle('is_hide');
        Element2.classList.toggle('is_hide')
    }
</script>
{% endblock %}